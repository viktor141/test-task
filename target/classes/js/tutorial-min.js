AJS.toInit(function(){JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(f,b,d){if(b&&typeof b.attr!=="undefined"&&b.attr("id")){console.log(" NEW_CONTENT_ADDED "+b.attr("id"));var c=jQuery("#sourceVal-"+b.attr("id").replace("-val",""));console.log(" elem "+c.length+" : sourceVal-"+b.attr("id").replace("-val",""));if(c.length>0){var a=c.attr("id");setupTutorialCF(a)}}});jQuery(document).bind("dialogContentReady",function(b,a){jQuery(".tutorial-cf-source").each(function(d){var c=jQuery(this).attr("id").replace("sourceVal-","");console.log(" cfId "+c);console.log(" cfId field "+jQuery("#"+c+"-single-select").length);if(jQuery("#"+c+"-single-select").length<1){setupTutorialCF(c)}})})});function setupTutorialCF(a){var a=a.replace("sourceVal-","");console.log("setupTutorialCF "+a);var b=jQuery("#sourceVal-"+a).val();var c=jQuery("#"+b).val();if(jQuery("#"+a).length<1){return}jQuery.ajax({method:"get",data:{customfieldId:a,sourceCFId:b,sourceVal:c},dataType:"json",url:contextPath+"/rest/tutorial-rest/latest/tutorial/initCf",success:function(d,g,f){var e=jQuery("#"+d.customfieldId);console.log(" initCf "+e+" : "+d.customfieldId);if(jQuery("#"+e.attr("id")+"-single-select").length>0){return}console.log(" cfId initCf "+jQuery("#"+d.customfieldId+"-single-select").length);new AJS.SingleSelect({handleFreeInput:function(h){},errorMessage:"",element:e,itemAttrDisplayed:"label",showDropdownButton:true,ajaxOptions:{data:function(h){return{sourceCFId:d.sourceCFId,sourceVal:jQuery("#"+d.sourceCFId).val(),customfieldId:d.customfieldId,query:h==""&&e.text()!="Not defined"?e.text():h}},url:contextPath+"/rest/tutorial-rest/latest/tutorial/searchCfRecords",query:true,formatResponse:function(i){var h=[];jQuery(i).each(function(k,j){var l=new AJS.GroupDescriptor({weight:k,label:j.header});jQuery(j.groups).each(function(){l.addItem(new AJS.ItemDescriptor({value:this.name,label:this.html,html:this.html,highlighted:true}))});h.push(l)});return h}}});e.change(function(){})},error:function(d,f,e){alert(e)}})};